\documentclass[10pt,a4paper]{article}
%\documentclass[10pt,a4paper]{beamer}
%\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
\usepackage{kpfonts}
\usepackage[numbers]{natbib}
%other options include: round, curly, angle, or default options

\usepackage{media9}
\usepackage{color}
\begin{document}
\author{\Large {Zhixuan Cao, Abani Patra, E. Bruce Pitman}}

\title{
\LARGE \textbf{Response to Reviewers} \\
\Large \textbf{``A Random Choice SPH Scheme with Adaptive Viscosity"}}

\date{\vspace{-5ex}}

\maketitle
The comments by the reviewers are recited in italics, followed by our reply in upright font. Revisions are highlighted with blue. Equation, section, figure and reference numbers in our response are corresponding to these in the original 
version of JCP manuscript if not specified. \\[12pt]

\textbf{\Large Reviewer \# 1}\\[3pt]

\textbf{\large General Comments}

\textit{This article describes an effort to combine the previous development of SPH technique with "Random Choice Method (RCM)", a classical approach developed in the framework of grid-based method for
describing fluid flows. The authors compare their method with standard SPH method and the first order GSPH, and show some interesting results and may provide useful information for the community of SPH developers. Therefore the reviewer would recommend its publication after the authors sufficiently react to some concerns described below.} 

We would like to thank the reviewer for carefully reading our manuscript and giving positive review and critical remarks.
We have revised the manuscript as described in the separate documentation and we hope that we have dealt with all suggestions in an adequate manner. The revised manuscript is also attached.
 
On behalf of all co-authors.

The following are our responses to reviewer's specific comments.\\[12pt]

\textbf{\large Specific comments}

\textit{The reviewer thinks that this kind of article should provide a new and useful method with respect to the previously known method. The usefulness may include (but not be restricted to) either higher accuracy, fast computation, implementation easiness, or versatility for the extension to include complex physics. According to the simulation examples shown in this article, the reviewer does not find the present method is more accurate than the second-order GSPH. (Note that it is not much more complicated than the first order GSPH. Instead, the reviewer thinks that the present method is (at least slightly) faster than those methods, and can be categorized in "faster methods" with approximate Riemann Solvers that includes development by Puri et al. With this respect, the reviewer thinks that comparison with the method of Puri et al. should be shown and explained in more detail. Note that the reviewer has no doubt in the
possibility of the present method for further development.}

To response reviewer's recommendation for comparing 1D tests in present article with these 1D tests by \citet{puri2014approximate}:

First of all, the present method simply adopts HLLC and Roe approximate Riemann solvers presented in \citep{puri2014approximate}. We did not make any improvement in term of approximate Riemann solvers. In that sense, these GSPH results in our paper should be kind of repeat of these tests in \citep{puri2014approximate}. Or in other words, we have already done such comparison in current paper.
But we need to mention two sources of differences. First of all, we adopted first order GSPH while tests in \citep{puri2014approximate} using second order GSPH. The reason why we use first order GSPH instead of second order GSPH is that we want to do ``well controlled" comparison. So that we can show the pure effect of ``random choice". Secondly, the shock tube tests adopted in our manuscript are very similar to these presented in \citep{puri2014approximate}, however, they are not exactly the same. We intentionally assign different particle mass to particles at left side and right side. The reason for different particle mass is explained in detail in appendix B of the revised manuscript.

In response to reviewer's comments regarding the usefulness 
The motivation and innovative point of the present method is to introduce numerical dissipation in a more adaptive manner, hence introduce less smearing around discontinuities. In that sense, the present work can be considered as ``higher numerical accurate", even though it is NOT ``higher order of accuracy". Another feature that made present method to be ``higher accurate" is its capability to better suppressing pressure wiggle at contact discontinuity. Both features have been demonstrated in 1D tests. Such improvements can be considered as "more accurate".
 
Thanks for helping us find another merit. Compared with second order GSPH, the present method would be, at least slightly, faster on expense of lower order accuracy. \\[3pt] 
%Compared with first order GSPH, it will not be faster. So the computational  speed would be a normal feature of present method instead of an attractive feature. 
%By adopting approximate Riemann solver, the present work would be computationally faster than RCM methods using iterative Riemann solver. If all previous RCM method is using iterative Riemann solver, then we may claim that it is the first time to combine RCM with non-iterative Riemann solver. And this would be another innovative point of our paper.

\textit{Since the random choice method (RCM) was introduced by Glimm in 1965 and seems to be discussed mainly around 1980, it is better to explain this method in more detail, especially why this method is expected to give a good result. Without such explanation the readers cannot understand why the present method may give better result than the other methods.}

We agree with reviewer. We added an appendix to introduce RCM with a little bit more details. More references are also provided there.\\[3pt]

\textit{Regrettably, Figure 4, 7, and 8 show relatively large oscillation in the
numerical results. Can you explain why this occurs? Is there any prescription to remove this?}

The large oscillations in these 1D shock tube tests actually are very critical in demonstrating the merit of present method. Unfortunately the original manuscript did not delivery this point clearly. The shock tube tests were intentionally designed to make such oscillation more obvious by assigning different particles masses. In all shock tube tests presented in previous work, uniform particle mass is adopted while in our manuscript, different particle mass are assigned for particles on right side and left side. Different particle mass will amplify the oscillation and help to demonstrate the merit of present method in a more obvious manner. In revised manuscript, we addressed these points. We also added an appendix explaining the source of such oscillations.
\\[3pt]
%need to show that equal particle mass can help reduce oscillation.

\textit{Section 4.4 is the most problematic. First of all, Figure 12 seems to be missing two additional figures, since the caption seems to describe three figures in each low. In general the reader cannot evaluate which method is superior to the others (only) by looking at these figures. The authors should improve the way to present the results.} 

In section 4.4, we first simulate the free jet flow using classical SPH based on different artificial viscosity coefficients. The results show that larger artificial viscosity coefficients can lead to shorter length of jet. Considering that larger artificial viscosity coefficients introduces more equivalent overall-dissipation. We reach to the conclusion that we can use the length of jet as a indirect indicator of equivalent overall-dissipation. 
Then we compared the length of jet simulated by GSPH and RSPH. As the length of GSPH is shorter, we inferred that RSPH introduces less equivalent overall-dissipation.
We modified the manuscript to delivery these points more clearly.
 
Figure for SPH results were removed while we forgot to update the caption, which makes Figure 12 to be confusing. That makes reader confusing. We revised the caption in our revised manuscript. 

We want to mention here that in both GSPH and the present method, the way to handle velocity that perpendicular to local coordinate system need to be improved. There are (at least) two different ways to handle the perpendicular velocity component. See [13] and [15]. We are adopting [13]'s method in this article. 
\\[3pt]


\textit{Note that the original GSPH paper [13] describes not only the first order method but also the second order method (and it effectively recommends the use of second order method). The authors seem to be missing these points. It is evident from the description in the following phrase: "Cha[14] proposed a second order accurate GSPH method by using a piecewise linear interpolation of the states." in Page 9 and "We observe a rate of convergence of approximately 1 for GSPH" in Page 17. These descriptions mislead the readers.}

The reviewer actually asked two questions here. 
With respect to the first question, yes, in our manuscript, we only compared RSPH with first order GSPH while GSPH could be second order as mentioned by the reviewer. The reason why we only compare our method with first order GSPH is that our method can only be first order. To make the comparison to be ``well controlled", we compared first order RSPH against first order GSPH. As reviewer has notified, RSPH and GSPH have many things in common: both need projecting quantities from global coordinate system to a local coordinate system, both need constructing local Riemann problem and solve the local Riemann problem, both need to project solution of the local Riemann solution back to global. In our ``well controlled" comparison, the only difference between RSPH and GSPH tests is the way to sample solution of local Riemann problems. This difference is actually also the essential difference between Godunov's method and random choice method in the context of mesh based method. With such ``well controlled" comparison, we can clearly show the effects purely due to the essential differences between RSPH and GSPH. We have to mention that such ``first order" limitation is inherited from RCM. Namely, RCM (which were proposed in mesh based methods) adopts a ``piece wise constant" way when constructing Riemann problems. This should be a disadvantage of RSPH compared with second order GSPH. 

With respect to the second question, yes, that statement would indeed cause confusions to readers. We added more explicit explanation in revised manuscript.
\\[3pt]

\textit {It is well known that the wiggle in the pressure at the contact discontinuity is due to the inconsistency of the standard SPH in evaluating pressure gradient force with a non-smooth distribution of particles. This problem is (at least partially) solved in GSPH [13, 17]. Note that the article [15] did not care this problem. Since the present article used the method shown in [15], the reviewer does not expect a good result at contact discontinuity. If the authors have some reason why the method that includes RCM can accurately describe the contact discontinuity, they should explain it within this article. The reviewer
presumes that it can be a desirable feature in the present method if it is true.}

[13] indeed shown that GSPH can almost get rid of pressure wiggle around contact discontinuity while standard SPH shows much more obvious pressure wiggle. They believe that the pressure wiggle is due to the inconsistency of EoM (equation of momentum) of the standard SPH. Or in other words, just as what the reviewer mentioned: "The wiggle in the pressure at the contact discontinuity is due to the inconsistency of the standard SPH in evaluating pressure gradient force with a non-smooth distribution of particles." However, there are different opinions with respect to the sources of pressure wiggle. For example, other researchers believe that the pressure wiggle has something to do with thermal conduction at the contact discontinuity. It has been shown that thermal conduction is essential to mitigate the spurious pressure wiggle at contact discontinuity in SPH [e.g. 4, 36, 37, 30]. As for GSPH, it is reported that an implicit thermal conduction is introduced by Godunov's scheme and helps suppress the anomaly [16]. Explanation in [16] seems to be more reasonable. Our observation in our 1D shock tube tests shows that even though both RSPH and GSPH adopt EoM proposed in [15], the pressure wiggle still get suppressed. So obviously, EoM might not be the real cause of pressure wiggle. 

The present method has many common things with GSPH. Particularly, both are based on solving local Riemann problems. Based on our observation that both GSPH and RSPH could suppress pressure wiggle in contact discontinuity. We tend to believe that the mechanism for present method to suppress pressure wiggle lies on the basis of present method: solving local Riemann problems. 
The capability of suppression pressure wiggle in contact discontinuity is indeed one attractive feature of present method.

As for why RSPH can better suppress pressure wiggles. It is not clear. We observed that RSPH is more adaptive than GSPH in terms of introducing artificial viscosity. Probably, better suppression of pressure wiggles is also because RSPH is more adaptive. 
\\[12pt]

\textbf{\Large Reviewer \# 2}\\[3pt]

\textbf{\large General Comments}

\textit{Summary: The authors propose a novel variant of a Riemann-solver based SPH scheme. The proposed scheme may well be viable and valuable/useful, but this is not sufficiently evident. The manuscript suffers from many confusing/lacking explanations and should be
substantially improved before seriously considered for publication in JCP.}

\textit{General Critique:
It remains unclear why RSPH performs better than GSPH, i.e. why the random choice of <epsilon> makes such a difference. It also remains unclear how well RSPH performs in critical multi-dimensional flows. In other words: the manuscript provides some suggestion that RSPH may a be a valuable scheme, but fails to explain why and to demonstrate that this is indeed the case for most flows.}

We appreciate the reviewer for reviewing our manuscript and giving constructive remarks. We understand that the reviewer has solid background in SPH but relatively less background in mesh based CFD (computational fluid dynamics) methods. Some questions/confusion are general question for mesh based CFD. We will try to give detailed response. But we might not include these details in our revised manuscript to avoid being too disruptive.

Our response to reviewer's general critique is following. 

Both random choice method (RCM) and Godunov's method have been proposed long time ago in the context of mesh based method. Both have been well studied in both theoretical side and application side. One advantage of RCM compared against Godunov's method is that RCM is able to introduce much less smearing at discontinuities. Such advantage is well known in the context of mesh based method.
The essential idea of GSPH, whose full name is Godunov SPH, is to implement Godunov's idea in the context of mesh free methods. The essential idea of RSPH, is to implement the idea of ``random choice" in the context of mesh free methods. Why random choice method would introduce much less smear has been well studied and demonstrated by many applications. It is not possible to cover all such topics in this article.
Considering the fact that some readers might not be familiar with random choice method. We added an appendix introduce RCM method with more references.

The attractive features of RSPH actually have been well demonstrated in 1D tests. However, some points are not clearly delivered. We will address these points in the revised manuscript.

As for 3D test case, it is hard to demonstrate the attractive feature of RSPH in a ``well controlled" manner. Indeed, in section 4.4, RSPH did not show very obvious advantage over GSPH. But we can still observe that the effective overall-dissipation introduced by RSPH is smaller than that of GSPH.
 
We also want to mention that, for higher dimensional implementation of RSPH and GSPH, how to approximate the velocity component that perpendicular to the local coordinate system is still not well understood. For example, there are two different approaches adopted by GSPH (see [13], [16], [17]). However, neither of them seems to be sufficient. This is a common topic for both GSPH and RSPH, not only for RSPH. In our implementation, we adopt the method used by [13] and [16]. 
\\[12pt]

\textbf{\large Specific comments}

\textit{p.2 The authors seem to misunderstand the purpose of artificial viscosity (AV) when they say it is "to overcome numerical oscillations at
discontinuities". SPH relies on representing all fields as SMOOTH and the purpose of AV is to ensure that this also holds for the flow velocity.
More generally, artificial dissipation is required to smooth any advected field (temperature, magnetic fields etc).}

Thanks for pointing this out. Our research focus more on high speed compressible flow and we were not able aware of the purpose of AV in a more general sense. For implementations of SPH in high speed compressible flow, the oscillation around discontinuities, especially aroud shocks can be too large or even corrupt whole simulation. In that sense, AV helps to reduce oscillation at discontinuities. So our statement is not as general as it should be, but still make sense in certain application area.
\\[3pt]

\textit{p.2 The adverse effects of AV in original SPH are misrepresented: artificial viscosity is not related to the failure to resolve contact discontinuities (which is caused by inconsistent smoothing, i.e. the pressure 'wiggle' in Fig 3, see also the review by Price 2012).}

We miss the reviewer's opinion here.
Do you mean: 
1) AV is not related to ``pressure wiggle" around contact discontinuity

OR
 
2) AV is related to failure to resolve discontinuities (note, include but not limited to contact discontinuities)? 

If what you mean is 1). our response is: 

We never say ``pressure wiggle" is due to AV. Instead, we prefer to agreeing with Price's view with respect to the source of ``pressure wiggle". As we mentioned in our response to another reviewer, thermal conduction can help mitigate ``pressure wiggle". The mechanism why RSPH can help mitigate ``pressure wiggle" is that RSPH, by solving local Riemann problems, introduces implicit thermal conduction. GSPH has been reported to mitigate ``pressure wiggle" in a similar mechanism [16]. We also want to mention that some other researchers have different view with respect to the source of ``pressure wiggle", see e.g. [13].

If what you mean is 2), our response is:

We do believe AV causes some issues when resolve discontinuities (not only contact discontinuities). That is, AV usually smears (or smooth out) discontinuities. Mathematically, discontinuity should be zero width, however, numerically, discontinuity would have width. Too large AV usually leads to larger width of discontinuities in numerical simulation. For example, in subplot c) of Fig. 3. larger AV (with $\alpha = 2$, the red dash line) lead to a wider approximation of the shock (which is discontinuity in theory) than smaller AV (with $\alpha = 1$, the purple line). 
Such wider approximation of discontinuity should not be considered as \textbf{failure} to resolve discontinuities. Instead, we prefer to calling wider approximation of discontinuity as \textbf{"not accurate enough or less accurate"}. One core merit of RSPH is to keep numerical approximation of discontinuities to be narrower by introducing numerical dissipation adaptively.
\\[3pt]
 
\textit{p.1/2 The "highly tuned versions of artificial viscosity" mentioned by the authors are in reality methods to adapt AV to flow regions where it is needed. These methods are by now widely used (in SPH models of compressive flows) and are therefore part of any modern implementation.
The authors fail to provide evidence for their bold claim that (the most advanced of) these methods "cannot properly accommodate every kind of wave that might arise, and spurious effects and unphysical damping persist" BECAUSE of AV (I agree that modern SPH still has issues, but AV is not their prime cause)..}

Response to reviewer's comments regarding AV.

We agree that AV might not be the biggest barrier that prevents SPH to be a real CFD tool as there are some other more serious challenges. However, AV is definitely an important aspect of CFD, especially for high speed compressible flow. It is more than necessary to borrow well developed ideas from mesh based method to SPH.
More importantly, both RCM and Godnuov's idea take the hyperbolicity of the system into account. The advantages of such treatment are not only introduce implicit (and adaptive) AV. Both GSPH and RSPH could also better suppress ``pressure wiggle" around contact discontinuity. The under underneath mechanism also relies on properly considering of system's hyperbolicity.

Response to reviewer's requests that we need to provide evidence for their bold claim that (the most advanced of) these methods "cannot properly accommodate every kind of wave that might arise, and spurious effects and unphysical damping persist"

These "highly tuned versions of artificial viscosity", as far as our understanding, none of them take the hyperbolicity of the system into account. How could these methods properly accommodate every kind waves without considering the property of system? Our claim is not bold at all.

The reviewer mentioned ``These methods are by now widely used in SPH models of compressive flows". With respect to these implementations, we are wondering what is the fluid speed? How accurate are they? Which physical quantities are of interest in these implementations (smearing of discontinuities might be acceptable for some implementations as there is not demands for resolving discontinuities as true discontinuities)?
We did not check all of these "highly tuned versions of artificial viscosity" in depth. But we did check the ADKE method carefully. It turned out that we have to tune its parameters manually even for different 1D tests. Some other researchers also reported the same thing, for example [12]. 
\\[3pt]
 
\textit{p1/2 The motivation of the new scheme via partially unjustified critique of artificial viscosity) is unnecessary and divisive. A much
better/correct motivation of RSPH would be as an improvement over standard GSPH.}

One of our original motivation indeed is to develop a method that can apply AV in a more ``smart" way. Even though the method turned out to have other attractive features.
The current way to add artificial viscosity does have some limitation and can be improved even though they work well in some implementations.
Compared with GSPH, RSPH do have some advantages while it also has some disadvantages. The major disadvantage is that RSPH can only be 1st order of accuracy.
We do not view RSPH as an improved version of GSPH, instead they should be two parallel methods. Because historically, RCM and Godunov's methods were developed (within the area of mesh based methods) parallely even though they share many common places.
\\[3pt]

\textit{p.3 The authors propose a variant of Godunov SPH. Owing to the irregular distribution of particles, such methods can only every be first-order accurate in h (Riemann-solver-based grid methods achieve second-order accuracy only because of the regular grid structure). This should be discussed.}

We prefer to viewing RSPH as counterpart of RCM in SPH while viewing GSPH as counterpart of Godunov's method in SPH. 
RSPH can only be first order even with regular particle distribution because the local Riemann problem is defined in a piece-wise constant manner. Not because the irregular distribution of particles. GSPH, would also be first order accuracy if its local Riemann problems are also defined in a piece-wise constant manner. However, GSPH could be second order of accuracy with regular particle distribution \textbf{and} ``piece-wise linear" construction of its local Riemann problem. However, GSPH would be between first order of accuracy its local Riemann problem is defined in a piece-wise linear manner \textbf{but} the particle distribution is irregular.
We added these discussions in revised paper.
\\[3pt]

\textit{p.3 Of course, in 1D, hydrodynamics is trivial, SPH has few problems, and
GSPH is 2nd order accurate. Really challenging problems only appear for multi-dimensional flows. Note that this does not imply that 1D test
problems are not useful, but these must be embedded in a multi-dimensional context, e.g. with periodic boundaries in the extra dimensions and with glass-like initial particle distributions, to really
demonstrate the validity of a method and compare with others..}

Surely higher dimensional problem are more challenging and make more sense in real applications. 
But 1D tests do have several great merits. 1) As relatively simpler tests, 1D tests are more easily to be well controlled. 2) 1D tests provide a solid basis for exploring basic property of a new method. 

What's more, even though trivial, there is still space for improvement for 1D tests. Many variants of SPH scheme can capture the position of different waves while most of them suffer from some common issues such as smearing of discontinuities, pressure wiggles around contact discontinuity, over shoot near other discontinuities. There is no variants of SPH method can perfectly handle all these issue. 

We want to mention that, these aspects might not be that important in some implementations. For example, smearing of discontinuity might not be an issue in case that the smoothed flow field is of more interested. But this does not mean that smearing of discontinuity is not important at all in any implementation.
\\[3pt]

\textit{p.6 The choice of the smoothing kernel is critical in SPH and the truncated Gaussian (eq 19) cannot be recommended. The authors should instead use the commonly used Wendland kernel (note, however that that has a different functional form for 1D and 2,3D). The problem with the truncated Gaussian (as presented in eq 19) is that it's neither continuous (at the outer boundary) nor normalized to unit integral. (Another problem is that it's computationally inefficient.)}

Thanks for pointing this out. We tried these two, For 1D tests case, it does not make visible difference. But for 3D, it did make some visible difference but did not change our conclusion. 
\\[3pt]

\textit{p.7 The choice of time integrator is also critical in SPH. Classical SPH is fully conservative and mass, momentum (linear and angular), energy, entropy are all conserved *exactly* modulo AV and time integration errors. It is therefore expedient to use a time integration scheme which does not introduce its own artificial dissipation, in particular NOT the forward Euler scheme.}

Yes, for real implementation, higher order time integrator is necessary. For this paper, first order scheme should be acceptable. Please be notified that all of our test cases adopting the same time integration scheme, in that sense, our comparison are still ``well controlled". RSPH can be combined with higher order time integration scheme. 
\\[3pt]

\textit{p.7 In eqs (21,22) <rho>(x) is not the true fluid density, but only the SPH density estimate. These two are different fields and must be carefully distinguished to avoid confusion and incorrect conclusions.}

We modified the symbol in revised version.
\\[3pt]

\textit{p.8,l.83 "Of course solving the local Riemann problem for every pair of interacting particles is a computationally intensive process." This should be qualified, in particular as an exact solution is overkill.}

Iterative Riemann solvers and non-iterative Riemann solvers have been well studied. There are many papers \citep[][e.g.]{roe1981approximate} and books \citep[][e.g.]{toro2013riemann} on this topic, really not necessary to cover any detail in this article.
\\[3pt]

\textit{p.8 The acronym "HLLC" should be qualified prior to first usage.}

Thanks, we have added the full phrase of HLLC in revised manuscripts.
\\[3pt]

\textit{p.9 The choice of a random final midpoint <epsilon> appears absurd. This must be better motivated/explained. I think this point sits at the very heart of the paper: why should using a random <epsilon> (instead of <epsilon>=0) improve the method?
Also, what is the motivation for the exact midpoint as the initial discontinuity of the Riemann problem? What determines which of a pair of particles is L and which R? Is this random? What motivates using the same value of <epsilon> for all particle pairs? Doesn't this defy the purpose of randomization? and introduce artificial correlations?}

The choice of a random final midpoint <epsilon> does sit at the very heart of the paper. We added an appendix to cover more details with respect to RCM method. Reviewer's questions, such as why using a random <epsilon>, why such random <epsilon> help introduce much less smearing of the discontinuities, what motivates using the same value of <epsilon> for all particle pairs, Doesn't this defy the purpose of randomization and introduce artificial correlations? had been asked and answered in the context of mesh based method. RSPH is the counterpart of RCM (which was previously proposed in mesh based method) in SPH. Discussions on these topics can be found in these papers. 

With respect to other questions, our answers are as following: 
\textit{Also, what is the motivation for the exact midpoint as the initial discontinuity of the Riemann problem?}
Good question. We do not have to use the exact middle point. Different way of determining the initial discontinuity would results to different variants of RSPH. For example, determining initial discontinuity based on particle mass. The property of these variants of RSPH is yet to explore. 

\textit{ What determines which of a pair of particles is L and which R? Is this random? }
L and R is determined according to the local coordinate system. For example, if we define the positive direction as from particle a to particle b, then a should be L and b should R. Whether positive direction of local coordinate system is from a to b or from b to a will NOT change the results as long as all the steps (projection from global to local, constructing of local Riemann problem and projection back from local to global) are using consistent local coordinate system (positive direction).
\\[3pt]


\textit{p.10 Fig.10 is confusing (it uses ``q" as coordinate, yet the caption(text) mentions ``x"; it uses an undefined ``w"; it uses sub-scripts ``L" and ``R", yet the caption talks about ``a" and `` b" states; the meaning of the lines ``$S_L$" , ``$S_M$", and ``$S_R$" is not explained)}

Thanks, we cleaned up these confusing points in revised manuscript.
\\[3pt]

\textit{p.10 The remark about the Van Der Corput pseudo-random number sequence is confusing/wrong. AFAIK, these are not pseudo-random, but QUASI-random. This seems to contradict the idea of using a random value. So why should this work?
What happens if instead pseudo-random numbers are used and/or if a different <epsilon> is drawn for every interacting particle pair?}

The idea of using Van Der Corput pseudo-random number sequence is borrowed from RCM. The reviewer is right that Van Der Corput pseudo-random number sequence not pseudo-random, but QUASI-random. But traditionally, it was called pseudo-random \citep[][e.g.]{toro2013riemann}. Should we follow the tradition of RCM or using more correct phrase? 

The idea of using a different <epsilon> for every interacting particle pair was actually another variants of RCM. These two different manners turned out to have similar properties. 
\\[3pt]

\textit{p.11/12 The summary of the 1D test cases is somewhat confusing. The initial conditions are not best explained in Table 1: where is the boundary? What is the physical meaning of negative-pressure ideal gas? (Standard SPH is unstable to clumping in the presence of negative pressure.)
These tests do not provide a good testsuite. Most operate at similar Mach numbers, albeit with different arrangements/initial conditions. It would
be desirable to test discontinuous initial conditions with a wider range of Mach numbers, from 0.1 to 100. The Mach number should be given in Table 1.}

The boundary is given in table by $[x_L, x_R]$.

There is a typo for test4 and test5 in that table, we incorrectly put value for velocity under pressure column, that's why you see negative pressure. We have changed it in revised manuscript.

The tests case adopted here are actually very representive to test \textbf{different wave patterns}. These 1D tests are all well known 1D tests used by both mesh based method \citep[][e.g.]{toro2013riemann, leveque2002finite} and SPH tests \citep[][e.g.]{monaghan1983shock, cha2003implementations, puri2014approximate}. 
Mach number can be easily calculated according to physical quantities. We added Mach number in Table 1 in revised manuscript. 
\\[3pt]

\textit{Figs 2,3 Are these really "oscillations around shock" for <alpha>=0.2 SPH? I suspect that instead we have inter-particle penetration, i.e.
particles swapping positions in 1D SPH. Also, in this figure, isn't the interpretation of oscillation==less viscosity rather simplistic? In a conservative scheme, the amount of dissipative heating can in principle be directly measured and used as a measure of viscosity (better than merely pointing at the oscillations).
I think it'd be better to combine Figs 2\& 3 into one, similar to Fig 4. Only one legend is required, not 8. Moreover, the details may be shown as inlet plots.}

They are really oscillations. However, such oscillations are caused by non-uniform smoothing length (due to non-uniform particle mass and density in space). We added an appendix to explain the source of such oscillation in the revised manuscript.

\textit{the amount of dissipative heating can in principle be directly measured and used as a measure of viscosity (better than merely pointing at the oscillations).}  

Using internal energy? We are a bit confused on how to measure the dissipative heating. The correlation between oscillation can be demonstrated by these tests with different artificial viscosity coefficients.

We tried to combine 2\&3 and 4\&5. But it would be too large to fit into one page. Inlet plots make it harder to see these details we want to show.

We made modification as suggested by reviewer regarding legend.
\\[3pt]

\textit{p.13-15 I think comparing against <alpha>=2 or 0.2 SPH has little merit.
A comparison to <alpha>=1 SPH makes sense as does a comparison (lacking)
against an AV-switch version of SPH.}

Both <alpha>=2 and 0.2 are necessary. Comparison of three different values confirms the effect AV, which is the basis of for our further discussion. If we only have two different artificial viscosity coefficients sets, some other readers might argue that our comparison is not generic enough.

The AV-switch versions of SPH, which introduce AV in an explicit way, usually have parameters that can be manually tuned while RSPH and GSPH introduce AV in an implicit way and have no manually-tunable parameters. 
We actually tried to compare against one AV-switch version of SPH. But it turned out that we have to manually tune its parameters for each test case. This can easily lead to ``unfair" comparison. In addition, the major difference between RSPH and AV-switch version of SPH is so obvious -- RSPH does not require explicit AV.
\\[3pt]

\textit{p14,15 The features of RSPH discussed here (adaptive viscosity) are the
natural consequence of the Riemann solver, i.e. of Godunov SPH. Nothing
is new here.}

Yes, these features of RSPH are due to Riemann solver. 
But Godunov's method is different from RCM.
They do share some common places but surely are different. If they are the same (or nothing new), how could RSPH introduce AV in a more adaptive manner as shown by these tests.

RSPH samples solution of local Riemann problem in a very different way from GSPH. This is NOT a small difference.
\\[3pt]

\textit{Fig 4 The two versions of GSPH have very similar symbols/colors and can hardly be distinguished.}

Changed in revised manuscript. 
\\[3pt]

\textit{p.16 What is the difference between the RSPH and GSPH-HLLC schemes? Is it
merely the choice of <epsilon>? I.e. is GSPH-HLLC == RSPH with <epsilon>=0? If not, what else is different? This is important, as one would like to understand what drives the differences between the results obtained by these to schemes (mostly near
the onset of the rarefaction region in Fig 4 where RSPH shows a wave while GSPH over-smoothes the rarefaction, but also the energy wiggle at
the contact discontinuity). As it is, this difference remains mysterious and unexplained.}

Yes, choice of <epsilon> is the only difference between \textbf{first order} GSPH-HLLC (GSPH can be second order). That is to say, \textbf{first order} GSPH-HLLC == RSPH with <epsilon>=0.
But this is NOT a small difference.
By the way, since choice of <epsilon> is the only difference, our tests are ``well controlled" comparison, that is to say, the difference in tests results do reflect the essential effect of different choice of <epsilon>. We hope reviewer can appreciate such manner of comparisons.

Why choice of <epsilon> can make such big difference? This is the heart of RCM.
\\[3pt]

\textit{pp. What causes the waves (in RSPH) and what is their wavelength? Perhaps
these waves are related to the correlations introduced by using the same
<epsilon> for all particle pairs (when their wavelength may be comparable
to / scale with h).}

Good question. We added an appendix to explain the source of these waves.
\\[3pt]

\textit{p.17 While simple 1D shock-tube problems are good tests for proof-of-concept implementations, they are not representative of
multi-dimensional flows and cannot be used to reliably validate any scheme. Thus, most tests in ยง4.2 are meaningless to that end.
A good test (where SPH performs poorly regardless of AV) is the Gresho-Chan vortex test (2D) run over at least one rotation period.}

We do agree that there are additional challenges for multi-dimensional implementations. But we would argue that 1D tests are must for any new method. These ``well controlled" tests could demonstrate the feature of the new method in a more explicit way. In addition, performing well in 1D tests are prerequirement for be doing well in higher dimensional implementations. We observe that many numerical schemes were throughly discussed in 1D and then implemented in 3D.
\\[3pt]

\textit{p.21 The free jet flow is an interesting problem but hardly suitable as a
test here, since there exists no undisputed correct solution (for a converging scheme, such a solution could be obtained by increasing resolution, but this has not been done).}

In terms of demonstrating basic features of RSPH, 1D tests can do a much better job as all factors are well controlled. 
As for 3D jet flow, yes, increasing resolution could help to get better results. But purely increasing resolution might no be enough. See more discussion based on a similar tests by \citet{cha2010kelvin}. 
In addition, different variant versions of RSPH might perform better in different implementations. However, this is not the major topic of this article.
\\[3pt]

\textit{Figs 11 \& 12 lack information which plot is for which scheme. Something is wrong in Fig.12: there are 2 rows of 2 plots each, yet the caption
talks about 2 rows of 3 plots each.}

Thanks, we modified this section to clean up confusions.
\\[3pt]
\bibliographystyle{plainnat}
\bibliography{Reference}
\end{document}