\documentclass[10pt,a4paper]{article}
%\documentclass[10pt,a4paper]{beamer}
%\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
\usepackage{kpfonts}
\usepackage[numbers]{natbib}
%other options include: round, curly, angle, or default options

\usepackage{media9}
\usepackage{color}
\begin{document}
\author{\Large {Zhixuan Cao, Abani Patra, E. Bruce Pitman}}

\title{
\LARGE \textbf{Response to Reviewers} \\
\Large \textbf{``A Random Choice SPH Scheme with Adaptive Viscosity"}}

\date{\vspace{-5ex}}

\maketitle
The comments by the reviewers are recited in italics, followed by our reply in upright font. Detailed revisions are shown separately in "a-summary-of-revisions.pdf". Equation, section, figure and reference numbers in our response are corresponding to these in the original 
version of JCP manuscript if not specified. We highlighted revsions in revised manuscript. Revisions made for first reviewer are highlighted in red. Revisions made for the second reviewer are highlighted in green. Revisions made for both are highlighted in yellow. Many of revisions are actually made for both reviewers and across sections. So we recommend to check the file "a-summary-of-revisions.pdf" for more detailed differences. \\[12pt]

\textbf{\Large Reviewer \# 1}\\[3pt]

\textbf{\large General Comments}

\textit{This article describes an effort to combine the previous development of SPH technique with "Random Choice Method (RCM)", a classical approach developed in the framework of grid-based method for
describing fluid flows. The authors compare their method with standard SPH method and the first order GSPH, and show some interesting results and may provide useful information for the community of SPH developers. Therefore the reviewer would recommend its publication after the authors sufficiently react to some concerns described below.} 

We would like to thank the reviewer for carefully reading our manuscript and giving positive review and critical remarks.
We have revised the manuscript as described in the separate documentation and we hope that we have dealt with all concerns in an adequate manner. The revised manuscript is also attached.
 
On behalf of all co-authors.

The following are our responses to reviewer's specific comments.\\[12pt]

\textbf{\large Specific comments}

\textit{The reviewer thinks that this kind of article should provide a new and useful method with respect to the previously known method. The usefulness may include (but not be restricted to) either higher accuracy, fast computation, implementation easiness, or versatility for the extension to include complex physics. According to the simulation examples shown in this article, the reviewer does not find the present method is more accurate than the second-order GSPH. (Note that it is not much more complicated than the first order GSPH. Instead, the reviewer thinks that the present method is (at least slightly) faster than those methods, and can be categorized in "faster methods" with approximate Riemann Solvers that includes development by Puri et al. With this respect, the reviewer thinks that comparison with the method of Puri et al. should be shown and explained in more detail. Note that the reviewer has no doubt in the
possibility of the present method for further development.}

To response to the reviewer's recommendation for comparing 1D tests in present article with these 1D tests by \citet{puri2014approximate}:

The present method merely adopts HLLC and Roe approximate Riemann solvers presented in \citep{puri2014approximate}. We did not make any improvement in term of approximate Riemann solvers. In that sense, these GSPH results in our paper are similar to these tests in \citep{puri2014approximate}, which combines GSPH with Riemann solvers proposed in that paper. Or in other words, we have already done (at least similar) comparison in current paper.
But we need to mention two sources of differences. First of all, we adopted piece wise constant RP construction in both GSPH and RSPH while tests in \citep{puri2014approximate} using piece wise linear RP construction. The reason why we use first order GSPH instead of second order GSPH is that Riemann problem construction (RPC) in RSPH is the same as RPC in first order GSPH. We want to do ``well controlled" comparison to show the pure effect of ``random choice". Secondly, the shock tube tests adopted in our manuscript are very similar to these presented in \citep{puri2014approximate}, however, they are not exactly the same. We intentionally assign different densities to particles at left side and right side in some of our 1D tests. This can lead to nonuniform smoothing length in space and induce more obvious numerical oscillation. More details are explained in appendix B of the revised manuscript.
Considering it is a common practice for GSPH to use piece wise linear RP construction.
We added comparison between RSPH and GSPH using  piece wise linear RP construction. 
[See Fig. 5 p. on 19 and 1st paragraph on p. 20]

In response to reviewer's comments regarding the usefulness of the method:

The motivation and innovative point of the present method is to introduce numerical dissipation in a more adaptive manner, hence introduce less smearing around discontinuities. In that sense, the present work can be considered as ``more numerically accurate", even though it is NOT ``higher order of accuracy". Another feature that makes present method ``more accurate" is its capability to better suppress pressure wiggle at contact discontinuity. Both features have been demonstrated in 1D tests. Such improvements can be considered as "more accurate".
 
Thanks for helping us find another merit of RSPH. Compared with second order GSPH, the present method would be, at least slightly, faster (due to less computation associated with RP construction).
[See last two sentence in 1st paragraph on p. 20 in revised manuscript] \\[3pt]

\textit{Since the random choice method (RCM) was introduced by Glimm in 1965 and seems to be discussed mainly around 1980, it is better to explain this method in more detail, especially why this method is expected to give a good result. Without such explanation the readers cannot understand why the present method may give better result than the other methods.}

We agree with reviewer. We added an appendix to introduce RCM with more details. More references are also provided there.
[See Appendix A on p. 30 to p. 32 in revised manuscript]\\[3pt]

\textit{Regrettably, Figure 4, 7, and 8 show relatively large oscillation in the
numerical results. Can you explain why this occurs? Is there any prescription to remove this?}

The large oscillations in these 1D shock tube tests actually are very critical in demonstrating the merit of present method. Such oscillations are caused by nonuniform smoothing length distribution in space (As explained in Appendix B in the revised manuscript). For 1D shock tube tests, smoothing lengths are usually not uniform in space. However, due to existence of sufficient numerical dissipation, such oscillations decay fast so are not obviously observed in most tests. In Fig 3, for example, we can not observe oscillation when $\alpha =1$ and $\alpha = 2$. When numerical dissipation is small ($\alpha = 0.2$), such oscillations are not completely suppressed and can be seen. Based on such observation, we use ``how much of the oscillation gets suppressed" as an indirect indicator for numerical dissipation. Our following discussions are based on such correlation between observable oscillation and numerical dissipation. Shock tube tests in this article are intentionally designed to have more obvious numerical oscillation. Test $1 \sim 4$ adopt different particle densities on right side and left side, which will lead to discontinuity of smoothing length at the middle. Such discontinuity in term of resolution is the source of numerical oscillation. In revised manuscript, we addressed these points. We also added an appendix explaining the mechanism for generating numerical oscillations. 
[See Appendix B on p. 32 to p. 38 in revised manuscript]
\\[3pt]

\textit{Section 4.4 is the most problematic. First of all, Figure 12 seems to be missing two additional figures, since the caption seems to describe three figures in each low. In general the reader cannot evaluate which method is superior to the others (only) by looking at these figures. The authors should improve the way to present the results.} 

In section 4.4, we first simulate the free jet flow using classical SPH based on different artificial viscosity coefficients. The results show that larger artificial viscosity coefficients can lead to shorter length of jet. Considering that larger artificial viscosity coefficients introduces more equivalent overall-dissipation. We reach to the conclusion that we can use the length of jet as a indirect indicator of equivalent overall-dissipation. 
Then we compared the length of jet simulated by GSPH and RSPH. As the length of GSPH is shorter, we inferred that RSPH introduces less equivalent overall-dissipation.
We modified the manuscript to delivery these points more clearly.
 
Figure for SPH results were moved to a separate figure while we forgot to update the caption, which makes Figure 12 to be confusing. We revised the caption in our revised manuscript.
[See Fig. 13 p. 28 in revised manuscript]
\\[3pt]


\textit{Note that the original GSPH paper [13] describes not only the first order method but also the second order method (and it effectively recommends the use of second order method). The authors seem to be missing these points. It is evident from the description in the following phrase: "Cha[14] proposed a second order accurate GSPH method by using a piecewise linear interpolation of the states." in Page 9 and "We observe a rate of convergence of approximately 1 for GSPH" in Page 17. These descriptions mislead the readers.}

The reviewer actually asked two questions here.
 
With respect to the first question, yes, in our manuscript, we only compared RSPH with first order GSPH while GSPH could be second order as mentioned by the reviewer. The reason why we only compare our method with first order GSPH is that our method can only be first order. To make the comparison to be ``well controlled", we compared first order RSPH against first order GSPH. As reviewer has notified, RSPH and GSPH have many things in common: both need projecting quantities from global coordinate system to a local coordinate system, both need constructing local Riemann problem and solve the local Riemann problem, both need to project solution of the local Riemann solution back to global. In our ``well controlled" comparison, the only difference between RSPH and GSPH tests is the way to sample solution of local Riemann problems. This difference is actually also the essential difference between Godunov's method and random choice method in the context of mesh based method. With such ``well controlled" comparison, we can clearly show the effects purely due to the essential differences between RSPH and GSPH. We have to mention that such ``first order" limitation is inherited from RCM. Namely, RCM (which were proposed in mesh based methods) adopts a ``piece wise constant" way when constructing Riemann problems. This should be a disadvantage of RSPH compared with (second order) GSPH.
It is not surprise to us that we observe first order of accuracy in our tests as we were testing first order GSPH.

With respect to the second question, yes, that statement would indeed cause confusions to readers. We added more explicit explanation in revised manuscript.
[See last paragraph on p. 20 and first two paragraphs in revised manuscript] 
\\[3pt]

\textit {It is well known that the wiggle in the pressure at the contact discontinuity is due to the inconsistency of the standard SPH in evaluating pressure gradient force with a non-smooth distribution of particles. This problem is (at least partially) solved in GSPH [13, 17]. Note that the article [15] did not care this problem. Since the present article used the method shown in [15], the reviewer does not expect a good result at contact discontinuity. If the authors have some reason why the method that includes RCM can accurately describe the contact discontinuity, they should explain it within this article. The reviewer
presumes that it can be a desirable feature in the present method if it is true.}

[13] indeed show that GSPH can almost get rid of pressure wiggle around contact discontinuity while standard SPH shows much more obvious pressure wiggle. They believe that the pressure wiggle is due to the inconsistency of EoM (equation of momentum) of the standard SPH. Or in other words, just as what the reviewer mentioned: "The wiggle in the pressure at the contact discontinuity is due to the inconsistency of the standard SPH in evaluating pressure gradient force with a non-smooth distribution of particles." However, there are different opinions with respect to the sources of pressure wiggle. For example, some other researchers believe that the pressure wiggle has something to do with thermal conduction at the contact discontinuity. It has been shown that thermal conduction is essential to mitigate the spurious pressure wiggle at contact discontinuity in SPH [e.g. 4, 36, 37, 30]. As for GSPH, it is reported that an implicit thermal conduction is introduced by Godunov's scheme and helps suppress the anomaly [16]. Explanation in [16] seems to be more reasonable. Our observation in our 1D shock tube tests shows that even though both RSPH and GSPH adopt EoM proposed in [15], the pressure wiggle is still suppressed. So obviously, EoM might not be the real cause of pressure wiggle. 

The present method has many things in common with GSPH. Particularly, both are based on solving local Riemann problems. Based on our observation that both GSPH and RSPH can suppress the pressure wiggle in contact discontinuity. We tend to believe that the mechanism for present method to suppress pressure wiggle lies in the basis of the present method: solving local Riemann problems. 
The capability to suppress pressure wiggle in contact discontinuity is indeed one attractive feature of present method.

As for why RSPH can better suppress pressure wiggles. It is not clear in theory. We observed that RSPH is more adaptive than GSPH in terms of introducing artificial viscosity. Probably, better suppression of pressure wiggles is also because RSPH is more adaptive in terms of introducing implicit thermal conduction (if Price is correct). 
\\[12pt]

\textbf{\Large Reviewer \# 2}\\[3pt]

\textbf{\large General Comments}

\textit{Summary: The authors propose a novel variant of a Riemann-solver based SPH scheme. The proposed scheme may well be viable and valuable/useful, but this is not sufficiently evident. The manuscript suffers from many confusing/lacking explanations and should be
substantially improved before seriously considered for publication in JCP.}

\textit{General Critique:
It remains unclear why RSPH performs better than GSPH, i.e. why the random choice of <epsilon> makes such a difference. It also remains unclear how well RSPH performs in critical multi-dimensional flows. In other words: the manuscript provides some suggestion that RSPH may a be a valuable scheme, but fails to explain why and to demonstrate that this is indeed the case for most flows.}

We appreciate the reviewer for carefully reviewing our manuscript and giving constructive remarks. We have made careful revision and hope that we have dealt with all concerns/suggestions in an adequate manner.

Our response to reviewer's general critique follows. 

Both random choice method (RCM) and Godunov's method have been proposed long time ago in the context of mesh based method. Both have been well studied in both theoretical side and application side. One advantage of RCM compared against Godunov's method is that RCM is able to introduce much less smearing at discontinuities. Such advantage is well known in the context of \textbf{mesh based method}.
The essential idea of GSPH, whose full name is Godunov SPH, is to migrate Godunov's idea to the context of mesh free methods. The essential idea of RSPH, is to implement the idea of ``random choice" in the context of mesh free methods. Why random choice method would introduce much less smear has been well studied and demonstrated by many applications in mesh based CFD. It is not possible to cover such topics in detail in the limited space available in this article.
Considering the fact that some readers might not be familiar with random choice method. We added an appendix introducing RCM method with more references.

The attractive features of RSPH actually have been well demonstrated in 1D tests. However, some points are not clearly delivered. We address these points in the revised manuscript.
[See last paragraph on p. 12 and p. 13 in revised manuscript.] 

As for 3D test case, the effective overall-dissipation is measured indirectly by the length that the 3D jet flow reaches in given time. We can still come to the conclusion that the effective overall-dissipation introduced by RSPH is smaller than that of GSPH. More work is necessary to explore its implementation in 3D. This is not the first priority of the very first paper on RSPH comunicating the core idea. Adopting different test cases might reveal more features and some shortcomings of RSPH in different scenarios. But implementing RSPH in different scenarios are not major goal of this article.
[See line 179 to the end of p. 13 in revised manuscript.]
\\[12pt]

\textbf{\large Specific comments}

\textit{p.2 The authors seem to misunderstand the purpose of artificial viscosity (AV) when they say it is "to overcome numerical oscillations at
discontinuities". SPH relies on representing all fields as SMOOTH and the purpose of AV is to ensure that this also holds for the flow velocity.
More generally, artificial dissipation is required to smooth any advected field (temperature, magnetic fields etc).}

Thanks for pointing this out. Our research focus on high speed compressible flow and we were not specific about the purpose of AV in a more general sense. For implementations of SPH in high speed compressible flow, the oscillation around discontinuities, especially around shocks can be too large to even corrupt whole simulation. For an extreme example, using SPH to do shock tube test with very small artificial viscosity (e.g. $\alpha = 0.01$), ends up huge osciallation or a failure of the solver. In that sense, AV helps to reduce oscillation at discontinuities. So our statement is not as general as it should be, but still make sense in the context of application.
[See first sentence in Abstract in revised manuscript.]
\\[3pt]

\textit{p.2 The adverse effects of AV in original SPH are misrepresented: artificial viscosity is not related to the failure to resolve contact discontinuities (which is caused by inconsistent smoothing, i.e. the pressure 'wiggle' in Fig 3, see also the review by Price 2012).}

We are confused about the reviewer's opinion here.
Do you mean: 
1) AV is not related to ``pressure wiggle" around contact discontinuity

OR
 
2) AV is related to failure to resolve discontinuities (include but not limited to contact discontinuities)? 

If opinion is 1). our response is: 

We also believe AV is not the source of pressure wiggle around contact discontinuity.
We never say ``pressure wiggle" is due to AV. Instead, we agree with Price's view with respect to the source of ``pressure wiggle". As we mentioned in our response to another reviewer, thermal conduction can help mitigate ``pressure wiggle". The mechanism why RSPH can help mitigate ``pressure wiggle" is that RSPH, by solving local Riemann problems, introduces implicit thermal conduction. GSPH has been reported to mitigate ``pressure wiggle" in a similar mechanism [16]. We also want to mention that some other researchers have different view with respect to the source of ``pressure wiggle", see e.g. [13].

If what you mean is 2), our response is:

We do believe AV causes some issues is solving discontinuities (not only contact discontinuities). That is, AV usually smears (or smooths out) discontinuities. Mathematically, discontinuity should be zero width, however, numerically, discontinuity would have width. Too large AV usually leads to larger width of discontinuities in numerical simulation. For example, in subplot c) of Fig. 3 in this article, larger AV (with $\alpha = 2$, the red dash line) lead to a wider approximation of the shock (which is discontinuity in theory) than smaller AV (with $\alpha = 1$, the purple line). 
Such wider approximation of discontinuity should not be considered as \textbf{failure} to resolve discontinuities. Instead, we prefer to calling wider approximation of discontinuity as \textbf{"not accurate enough or less accurate"}. One core merit of RSPH is to keep numerical approximation of discontinuities to be narrower by introducing numerical dissipation adaptively.
\\[3pt]
 
\textit{p.1/2 The "highly tuned versions of artificial viscosity" mentioned by the authors are in reality methods to adapt AV to flow regions where it is needed. These methods are by now widely used (in SPH models of compressive flows) and are therefore part of any modern implementation.
The authors fail to provide evidence for their bold claim that (the most advanced of) these methods "cannot properly accommodate every kind of wave that might arise, and spurious effects and unphysical damping persist" BECAUSE of AV (I agree that modern SPH still has issues, but AV is not their prime cause)..}

Response to reviewer's comments regarding AV.

We agree that AV might not be the biggest barrier that prevents SPH to be a real CFD tool as there are some other more serious challenges. However, AV is definitely an important aspect of CFD, especially for high speed compressible flow. It is more than necessary to borrow well developed ideas from mesh based method to SPH.
More importantly, both RCM and Godnuov's idea take the hyperbolicity of the system into account and the advantages of such treatment are not only to introduce implicit (and adaptive) AV but both GSPH and RSPH also suppress the ``pressure wiggle" around contact discontinuity. The underlying mechanism for supressing the wiggles relies on properly considering of system's hyperbolicity.

We would like to response to reviewer's requests that we need to provide evidence for our claim that (the most advanced of) that these highly tuned SPH methods "cannot properly accommodate every kind of wave that might arise, and spurious effects and unphysical damping persist" by stating that these "highly tuned versions of artificial viscosity", as far as we know, do not take the hyperbolicity of the system into account. It is unlikely that these methods properly accommodate every kind of waves without considering the property of system. Our claim is not really bold at all.

The reviewer mentioned ``These methods are by now widely used in SPH models of compressive flows". With respect to these implementations, we would liket to understand for what is the fluid speeds? How accurate are they? and which physical quantities are of interest in these implementations (smearing of discontinuities might be acceptable for some implementations as there is not requirements for resolving discontinuities as true discontinuities if detailed flow field structure are not of interest)?
We did not check all of these "highly tuned versions of artificial viscosity" in depth. But we did check the ADKE method carefully. It turned out that we have to tune its parameters manually even for different 1D tests. Some other researchers also reported the same thing, for example [12]. You can image that how could we manually adjust parameters for real implementations in higher dimension?
\\[3pt]
 
\textit{p1/2 The motivation of the new scheme via partially unjustified critique of artificial viscosity) is unnecessary and divisive. A much
better/correct motivation of RSPH would be as an improvement over standard GSPH.}

Our original motivation indeed was to develop a method that can apply AV in a more ``smart" way even though the method turned out to have other attractive features.
The current way to add artificial viscosity in standard SPH does have some limitations and can be improved even though they work well in some implementations.
Compared with GSPH, RSPH does have some advantages while it also has some disadvantages. The major disadvantage is that RSPH can only adopt piece wise constant Riemann problem construction.
We do not view RSPH as an improved version of GSPH, instead they should be two parallel methods. Because historically, RCM and Godunov's methods were developed (within the area of mesh based methods) parallely even though they share many common features.
\\[3pt]

\textit{p.3 The authors propose a variant of Godunov SPH. Owing to the irregular distribution of particles, such methods can only every be first-order accurate in h (Riemann-solver-based grid methods achieve second-order accuracy only because of the regular grid structure). This should be discussed.}

Yes, the irregular distribution of particles is one  major thing that prevents SPH schemes (standard SPH, GSPH and RSPH) to be second order. Besides that, for both GSPH and RSPH, how to construct the local Riemann problem would also affect order of accuracy.
Standard SPH, can be maximum second order of accuracy. As for grid methods, things are different. Order of accuracy could be as high as needed. For example, for finite difference, we can easily achieve that by inlcuding more nodes in approximation. This is one disadvantage of SPH compared with mesh based method. As for Riemann-solver-based grid methods, the bottle neck is the order of accuracy when constructing local Riemann problems. Local Riemann problems can be constructed in piece-wise constant manner (zeroth order), piece-wise linear manner (first order) and so on ...

We added discussions regarding irregular particle distributions in revised manuscript. [See line 262 to 272 on p. 30 and p. 31 in revised manuscript.]
\\[3pt]

\textit{p.3 Of course, in 1D, hydrodynamics is trivial, SPH has few problems, and
GSPH is 2nd order accurate. Really challenging problems only appear for multi-dimensional flows. Note that this does not imply that 1D test
problems are not useful, but these must be embedded in a multi-dimensional context, e.g. with periodic boundaries in the extra dimensions and with glass-like initial particle distributions, to really
demonstrate the validity of a method and compare with others..}

Surely higher dimensional problems are more challenging and make important sense in real applications. 
But 1D tests do have several great merits. 1) As relatively simpler tests, 1D tests are more easily to be well controlled. 2) 1D tests provide a solid basis for exploring basic property of a new method. 3)Computationally fast and easy to implement, so are handy tools for learning, initial investigating or comparing different numerical methods. 

What's more, even though trivial, there is still space for improvement for 1D tests. Many variants of SPH scheme can capture the position of different waves while most of them suffer from some common issues such as smearing of discontinuities, pressure wiggles around contact discontinuity and over shoot near other discontinuities. There is no variants of SPH method can perfectly handle all these issue. In that sense, it is not that trival.

We want to mention that, these aspects might not be that important in some implementations. For example, smearing of discontinuity might not be an issue in case that the smoothed flow field is of more interested. But this does not mean that smearing of discontinuity is not important at all in any implementation.
\\[3pt]

\textit{p.6 The choice of the smoothing kernel is critical in SPH and the truncated Gaussian (eq 19) cannot be recommended. The authors should instead use the commonly used Wendland kernel (note, however that that has a different functional form for 1D and 2,3D). The problem with the truncated Gaussian (as presented in eq 19) is that it's neither continuous (at the outer boundary) nor normalized to unit integral. (Another problem is that it's computationally inefficient.)}

Thanks for pointing this out. We tried these two, For 1D tests case, it does not make visible difference. But for 3D, it did make some visible difference but did not change our conclusion.

By the way, the truncated Gaussian, if truncated at 3 times of smoothing length, which is adopted in our implementation, would add up to 0.9974. The difference is less than 0.3 percent. 
In terms of deficiency near boundray, we did adopt a "re-normalization" strategy in the 3D tests. We did not mention such details as we feel such technical detail is not related to the major point we are try to delivery in this article and would be distractive for readers. 
When implementing RSPH, one can choose to use whichever kernel if approproate for the application of interest.
\\[3pt]

\textit{p.7 The choice of time integrator is also critical in SPH. Classical SPH is fully conservative and mass, momentum (linear and angular), energy, entropy are all conserved *exactly* modulo AV and time integration errors. It is therefore expedient to use a time integration scheme which does not introduce its own artificial dissipation, in particular NOT the forward Euler scheme.}

Yes, for real implementation, higher order time integrator is necessary. For this paper, first order scheme should be acceptable. Please note that all of our test cases adopt the same time integration scheme, in that sense, our comparisons are still ``well controlled". RSPH can be combined with higher order time integration schemes.
\\[3pt]

\textit{p.7 In eqs (21,22) $\rho(x)$ is not the true fluid density, but only the SPH density estimate. These two are different fields and must be carefully distinguished to avoid confusion and incorrect conclusions.}

We modified the symbol in revised version. [See Eq. 21 to 22 on p. 7 in revised manuscript.]
\\[3pt]

\textit{p.8,l.83 "Of course solving the local Riemann problem for every pair of interacting particles is a computationally intensive process." This should be qualified, in particular as an exact solution is overkill.}

Iterative Riemann solvers and non-iterative Riemann solvers have been well studied for many years. There are many papers \citep[][e.g.]{roe1981approximate} and books \citep[][e.g.]{toro2013riemann} on this topic, really not necessary to cover any details.
\\[3pt]

\textit{p.8 The acronym "HLLC" should be qualified prior to first usage.}

Thanks, we have added the full phrase of HLLC in revised manuscripts.
[See line 94 on p. 8 in revised manuscript.]
\\[3pt]

\textit{p.9 The choice of a random final midpoint $\epsilon$ appears absurd. This must be better motivated/explained. I think this point sits at the very heart of the paper: why should using a random $\epsilon$ (instead of $\epsilon$=0) improve the method?
Also, what is the motivation for the exact midpoint as the initial discontinuity of the Riemann problem? What determines which of a pair of particles is L and which R? Is this random? What motivates using the same value of $\epsilon$ for all particle pairs? Doesn't this defy the purpose of randomization? and introduce artificial correlations?}

The choice of a random final midpoint $\epsilon$ does sit at the very heart of the paper. We added an appendix to cover more details with respect to RCM method. Reviewer's questions, such as why are we using a random $\epsilon$, why a such random $\epsilon$ help introduce much less smearing of the discontinuities, what motivates using the same value of $\epsilon$ for all particle pairs, Doesn't this defy the purpose of randomization and introduce artificial correlations? had been asked and answered in the context of mesh based method. RSPH is the counterpart of RCM (which was previously proposed in mesh based method) in SPH.

With respect to other questions, our answers are as following: 
\textit{Also, what is the motivation for the exact midpoint as the initial discontinuity of the Riemann problem?}
Good question. We do not have to use the exact middle point. Different way of determining the initial discontinuity would results to different variants of RSPH. One could, for example, determineinitial discontinuity based on particle mass. The property of these variants of RSPH are yet to explore. [Add comments at line 377 to line 379 on p. 30 in revised manuscript.]

\textit{ What determines which of a pair of particles is L and which R? Is this random? }
L and R is determined according to the local coordinate system. For example, if we define the positive direction as from particle a to particle b, then a should be L and b should R. Whether positive direction of local coordinate system is from a to b or from b to a will NOT change the results as long as all the steps (projection from global to local, constructing of local Riemann problem and projection back from local to global) are using consistent local coordinate system (positive direction). More details can be found in the first GSPH paper[13].
\\[3pt]


\textit{p.10 Fig.10 is confusing (it uses ``q" as coordinate, yet the caption(text) mentions ``x"; it uses an undefined ``w"; it uses sub-scripts ``L" and ``R", yet the caption talks about ``a" and `` b" states; the meaning of the lines ``$S_L$" , ``$S_M$", and ``$S_R$" is not explained)}

Thanks, we cleaned up these confusing points in revised manuscript. 
[See Fig. 13 on p. 8 in revised manuscript.]
\\[3pt]

\textit{p.10 The remark about the Van Der Corput pseudo-random number sequence is confusing/wrong. AFAIK, these are not pseudo-random, but QUASI-random. This seems to contradict the idea of using a random value. So why should this work?
What happens if instead pseudo-random numbers are used and/or if a different $\epsilon$ is drawn for every interacting particle pair?}

The idea of using Van Der Corput pseudo-random number sequence is borrowed from RCM. The reviewer is right that Van Der Corput pseudo-random number sequence not pseudo-random, but QUASI-random. But traditionally, it was called pseudo-random \citep[][e.g.]{toro2013riemann}. We have choosen to follow the tradition of RCM rather than using more correct phrase.

The idea of using a different $\epsilon$ for every interacting particle pair was actually another variant of RCM. These two different manners turned out to have similar properties. 
[See line 396 to 397 on p. 31 in revised manuscript.]
\\[3pt]

\textit{p.11/12 The summary of the 1D test cases is somewhat confusing. The initial conditions are not best explained in Table 1: where is the boundary? What is the physical meaning of negative-pressure ideal gas? (Standard SPH is unstable to clumping in the presence of negative pressure.)
These tests do not provide a good testsuite. Most operate at similar Mach numbers, albeit with different arrangements/initial conditions. It would
be desirable to test discontinuous initial conditions with a wider range of Mach numbers, from 0.1 to 100. The Mach number should be given in Table 1.}

The boundary is given in table by $[x_L, x_R]$.

There is a typo for test4 and test5 in that table, we incorrectly put value for velocity under pressure column, that's why you see negative pressure. We have changed it in revised manuscript.

The tests case adopted here are actually very representative to test \textbf{different wave patterns}. These 1D tests are all well known 1D tests used by both mesh based method \citep[][e.g.]{toro2013riemann, leveque2002finite} and SPH tests \citep[][e.g.]{monaghan1983shock, cha2003implementations, puri2014approximate}.

Mach number can be easily calculated according to physical quantities and \textbf{is a function of time and space}. We are confused about which Mach number the reviewer is asking for, at which time, at which location?
We claim that our 1D tests are comprehensive because they can cover all possible wave patterns that could arise in 1D and two extreme cases.
\\[3pt]

\textit{Figs 2,3 Are these really "oscillations around shock" for $\alpha$=0.2 SPH? I suspect that instead we have inter-particle penetration, i.e.
particles swapping positions in 1D SPH. Also, in this figure, isn't the interpretation of oscillation==less viscosity rather simplistic? In a conservative scheme, the amount of dissipative heating can in principle be directly measured and used as a measure of viscosity (better than merely pointing at the oscillations).
I think it'd be better to combine Figs 2\& 3 into one, similar to Fig 4. Only one legend is required, not 8. Moreover, the details may be shown as inlet plots.}

Reviewer's questions are answered separately in following: 

\textit{Figs 2,3 Are these really "oscillations around shock" for $\alpha$=0.2 SPH? I suspect that instead we have inter-particle penetration, i.e.
particles swapping positions in 1D SPH. Also, in this figure, isn't the interpretation of oscillation==less viscosity rather simplistic? }

They are really oscillations. Such oscillations are caused by nonuniform smoothing length in space (due to uniform particle mass and nonuniform density in space). We added an appendix to explain the source of such oscillation in the revised manuscript.
Besides oscillation, we also use another indirect indicator for viscosity for 1D tests, that is, how much the shock is smeared. Both indicators of numerical dissipation (viscosity) reveal consistent information. 

More importantly, in SPH tests, where we can control the amount of viscosity explicitly by using different artificial viscosity coefficients, these two indicators reflect consistent information. For example, in plot c) of Fig. 3, smaller artificial viscosity coefficients lead to less smearing of shock (narrower width) and larger oscillation. This just proves that, the oscillation and the degree the shock is smeared are effective and valid indicator of viscosity.
[Modifications to address these concerns are accross section 4, appendix A and appendix B in revised manuscript.]

\textit{the amount of dissipative heating can in principle be directly measured and used as a measure of viscosity (better than merely pointing at the oscillations).}  

We are a bit confused on how to measure the dissipative heating. Using increases of internal energy? Internal energy is plotted for all of the 1D tests. We can barely see any increase in terms of internal energy. But the correlation between oscillation and viscosity is demonstrated by these SPH tests with different artificial viscosity coefficients. So practically, oscillation is an effective way to measure viscosity.
[Explanations to address these concerns are accross section 4, appendix A and appendix B in revised manuscript.]

\textit{I think it'd be better to combine Figs 2\& 3 into one, similar to Fig 4.}

We tried to combine 2\&3 and 4\&5. But it would be too large to fit into one page. Inlet plots make it harder to see the details we want to show.

\textit{Only one legend is required, not 8. Moreover, the details may be shown as inlet plots.} 

We made modification as suggested by reviewer regarding legend. 
[See Fig. 2 to 11 in section 4 in revised manuscript.]\\[3pt]

\textit{p.13-15 I think comparing against $\alpha$=2 or 0.2 SPH has little merit.
A comparison to $\alpha$=1 SPH makes sense as does a comparison (lacking)
against an AV-switch version of SPH.}

Both $\alpha$=2 and 0.2 are necessary. Comparison of three different artificial viscosity coefficients in SPH confirms how could AV affect the oscillation, how could AV smear the shock and how could AV affect the distance between nozzle and the front of jet flow. Those are the basis of for our further discussion. If we only have two different artificial viscosity coefficients sets, some other readers might argue that our comparison is not general enough.

The AV-switch versions of SPH, which introduce AV in an explicit way, usually have parameters that can be manually tuned while RSPH and GSPH introduce AV in an implicit way and have no manually-tunable parameters. 
We actually tried to compare against one AV-switch version of SPH. But it turned out that we have to manually tune its parameters for each test case. This can easily lead to ``unfair" comparison. In addition, the major difference between RSPH and AV-switch version of SPH is so obvious -- RSPH does not require explicit AV.
\\[3pt]

\textit{p14,15 The features of RSPH discussed here (adaptive viscosity) are the
natural consequence of the Riemann solver, i.e. of Godunov SPH. Nothing
is new here.}

Yes, these features of RSPH are due to Riemann solver. 
But Godunov's method is different from RCM.
They do share some common places but surely are different. If they are the same (or nothing new), how could RSPH introduce AV in a more adaptive manner as shown by many tests.

RSPH samples solution of local Riemann problem in a very different way from GSPH. This is NOT a small difference. Just like RCM and Godunov's method are considered as two different method in mesh based CFD methods.
\\[3pt]

\textit{Fig 4 The two versions of GSPH have very similar symbols/colors and can hardly be distinguished.}

Colours are changed in revised manuscript, we also use thicker lines. 
[See Fig. 4 in section 4 in revised manuscript.]
\\[3pt]

\textit{p.16 What is the difference between the RSPH and GSPH-HLLC schemes? Is it
merely the choice of $\epsilon$? I.e. is GSPH-HLLC == RSPH with $\epsilon$=0? If not, what else is different? This is important, as one would like to understand what drives the differences between the results obtained by these to schemes (mostly near
the onset of the rarefaction region in Fig 4 where RSPH shows a wave while GSPH over-smoothes the rarefaction, but also the energy wiggle at
the contact discontinuity). As it is, this difference remains mysterious and unexplained.}

Yes, choice of $\epsilon$ is the only difference between \textbf{first order} GSPH-HLLC (GSPH can be second order). That is to say, \textbf{first order} GSPH-HLLC == RSPH with $\epsilon$=0.
But this is NOT a small difference.
By the way, since choice of $\epsilon$ is the only difference, our tests are ``well controlled" comparison, that is to say, the difference in tests results do reflect the essential effect of different choice of $\epsilon$. We hope reviewer can appreciate such manner of comparisons.

Why choice of $\epsilon$ can make such big difference? This is the heart of RCM. We explained it a little bit in Appendix A in the revised paper.  [See Fig. 2 to 11 in section 4 in revised manuscript.]
\\[3pt]

\textit{pp. What causes the waves (in RSPH) and what is their wavelength? Perhaps
these waves are related to the correlations introduced by using the same
$\epsilon$ for all particle pairs (when their wavelength may be comparable
to / scale with h).}

Good question. We added an appendix to explain the source of these waves (oscillations).
[See appendix B in revised manuscript.]
\\[3pt]

\textit{p.17 While simple 1D shock-tube problems are good tests for proof-of-concept implementations, they are not representative of
multi-dimensional flows and cannot be used to reliably validate any scheme. Thus, most tests in §4.2 are meaningless to that end.
A good test (where SPH performs poorly regardless of AV) is the Gresho-Chan vortex test (2D) run over at least one rotation period.}

We do agree that there are additional challenges for multi-dimensional implementations. But we would argue that 1D tests are must for any new method. These ``well controlled" tests could demonstrate the feature of the new method in a more explicit way. In addition, performing well in 1D tests are prerequirement for be doing well in higher dimensional implementations. We observe that many numerical schemes were throughly discussed in 1D and then implemented in 3D.
\\[3pt]

\textit{p.21 The free jet flow is an interesting problem but hardly suitable as a
test here, since there exists no undisputed correct solution (for a converging scheme, such a solution could be obtained by increasing resolution, but this has not been done).}

In terms of demonstrating basic features of RSPH, 1D tests can do a much better job as all factors are well controlled. 
As for 3D jet flow, yes, increasing resolution could help to get better results. But purely increasing resolution might no be enough. See more discussion based on a similar tests by \citet{cha2010kelvin}. 
In addition, different variant versions of RSPH might perform better in different implementations. However, this is not the major topic of this article.
\\[3pt]

\textit{Figs 11 \& 12 lack information which plot is for which scheme. Something is wrong in Fig.12: there are 2 rows of 2 plots each, yet the caption
talks about 2 rows of 3 plots each.}

Thanks, we modified this section to clean up any confusions.
[See Fig. 13 on p. 28 in revised manuscript.]
\\[3pt]
\bibliographystyle{plainnat}
\bibliography{Reference}
\end{document}